<!DOCTYPE html>
<html>
<head>
    <title>ğŸ› Pest Management - CropCareAI</title>
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <div id="header-container"></div>
    
    <div class="container">
        <div class="module-container">
            <h2>ğŸ› Pest Management</h2>
            <p>Get pest control solutions</p>
            
            <div class="input-group">
                <label for="pestType">Pest Type:</label>
                <select id="pestType">
                    <option value="aphids">ğŸ¦Ÿ Aphids</option>
                    <option value="caterpillar">ğŸ› Caterpillar</option>
                    <option value="fungus">ğŸ„ Fungus</option>
                    <option value="whiteflies">ğŸ¦‹ Whiteflies</option>
                </select>
            </div>
            
            <div class="input-group">
                <label for="cropTypePest">Affected Crop:</label>
                <select id="cropTypePest">
                    <option value="wheat">ğŸŒ¾ Wheat</option>
                    <option value="corn">ğŸŒ½ Corn</option>
                    <option value="rice">ğŸš Rice</option>
                    <option value="tomato">ğŸ… Tomato</option>
                </select>
            </div>
            
            <div class="input-group">
                <label for="severity">Infestation Severity:</label>
                <select id="severity">
                    <option value="1">ğŸŸ¢ Mild (1) - Few pests spotted</option>
                    <option value="2">ğŸŸ¡ Moderate (2) - Visible damage</option>
                    <option value="3">ğŸ”´ Severe (3) - Heavy infestation</option>
                </select>
            </div>
            
            <button class="btn" onclick="getPesticideRecommendation()">ğŸ› Get Pest Solution</button>
            <div id="pesticideResult" class="result"></div>
        </div>
    </div>
    
    <div id="footer-container"></div>

    <script src="assets/js/common.js"></script>
    <script>
        async function getPesticideRecommendation() {
            showResult('pesticideResult', '<div class="loading">ğŸ” Analyzing pest situation and severity...</div>');
            try {
                const response = await fetch(`${API_BASE}/pesticide-recommendation`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        pest_type: document.getElementById('pestType').value,
                        crop_type: document.getElementById('cropTypePest').value,
                        severity: parseInt(document.getElementById('severity').value)
                    })
                });
                const result = await response.json();
                if (result.status === 'success') {
                    const rec = result.recommendation;
                    showResult('pesticideResult', `
                        <strong>âœ… Pest Solution Ready</strong>
                        <br><br>
                        <strong>ğŸ§´ Treatment:</strong> ${rec.pesticide}<br>
                        <strong>ğŸ“ Dosage:</strong> ${rec.dosage}<br>
                        <strong>â° Frequency:</strong> ${rec.frequency}<br>
                        ${rec.note ? `<br><em>ğŸ’¡ ${rec.note}</em>` : ''}
                    `);
                } else {
                    showResult('pesticideResult', `âŒ Error: ${result.error}`, 'warning');
                }
            } catch (error) {
                showResult('pesticideResult', `âŒ Network error: ${error}`, 'warning');
            }
        }
    </script>
</body>
</html>