<!DOCTYPE html>
<html>
<head>
    <title>ğŸ’° Market Analysis - CropCareAI</title>
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <div id="header-container"></div>
    
    <div class="container">
        <div class="module-container">
            <h2>ğŸ’° Market Analysis</h2>
            <p>Price predictions and market trends (Under Development)</p>
            
            <div class="dev-notice">
                ğŸš§ <strong>Under Development:</strong> This module is currently being enhanced with advanced ML models for better price predictions.
            </div>
            
            <div class="input-group">
                <label for="marketCrop">Crop for Analysis:</label>
                <select id="marketCrop">
                    <option value="wheat">ğŸŒ¾ Wheat</option>
                    <option value="rice">ğŸš Rice</option>
                    <option value="corn">ğŸŒ½ Corn</option>
                    <option value="cotton">ğŸ§µ Cotton</option>
                    <option value="sugarcane">ğŸ‹ Sugarcane</option>
                </select>
            </div>
            
            <button class="btn btn-development" onclick="getMarketAnalysis()">ğŸ’° Analyze Market</button>
            <div id="marketResult" class="result warning"></div>
        </div>
    </div>
    
    <div id="footer-container"></div>

    <script src="assets/js/common.js"></script>
    <script>
        async function getMarketAnalysis() {
            showResult('marketResult', '<div class="loading">ğŸ’¹ Analyzing market trends and price data...</div>');
            try {
                const response = await fetch(`${API_BASE}/market-analysis`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        crop_type: document.getElementById('marketCrop').value
                    })
                });
                const result = await response.json();
                if (result.status === 'success') {
                    const analysis = result.market_analysis;
                    showResult('marketResult', `
                        <strong>ğŸ’° Market Analysis Report</strong>
                        <br><br>
                        <strong>ğŸŒ¾ Crop:</strong> ${document.getElementById('marketCrop').value}<br>
                        <strong>ğŸ’° Estimated Price:</strong> $${analysis.predicted_price} ${analysis.currency}<br>
                        <br><em>${analysis.note}</em>
                    `, 'info');
                } else {
                    showResult('marketResult', `âŒ Error: ${result.error}`, 'warning');
                }
            } catch (error) {
                showResult('marketResult', `âŒ Network error: ${error}`, 'warning');
            }
        }
    </script>
</body>
</html>